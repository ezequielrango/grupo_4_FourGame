<!DOCTYPE html>
<html lang="es">

    <%- include("./partials/head", {title: 'Editar producto'}) %> 

<body class="loading">
    <%- include("./partials/header")%> 
    <main>
          <h1 class="title"><small>Estas editando el producto</small> : <%=product.name%></h1>
          
          <form class="formCreacion" action="/products/edit/<%=product.id %>?_method=PUT " method="POST" enctype="multipart/form-data">

            <!----------------------------------    BOOSTRAP   ------------------------------------------>
            <div class="c-title-error">
              <label class="form-label title-images">Selecciona las imagenes : </label>
              <%if( locals.errors && locals.errors.image){%>
                <p style="color: red;margin: unset;"><%=errors.image.msg%></p>
              <%}%>
            </div>
            <div class="c-imagenes">
              <div class="mb-3 input-file">
                <div class="preview" id="preview">
                  <img id="preview-image" src="<%=product.image[0] ? `/images/products/${product.image[0]}` : "/images/icon/default-image1.png" %>">
                  <input class="delete" type="checkbox" name="deleteImages" value=6 id="0" checked>
                </div>
                <input type="file" id="image" name="image" class="file">
                <label for="image" class="file-agregar btn" onclick="document.getElementById(`0`).value = `0`;">Agregar</label>
                <button type="button" id="quitar" onclick="limpiar(`image`,`preview-image`,`0`)" class="file-quitar btn">Quitar</button>
              </div>

              <div class="mb-3 input-file">
                <div class="preview" id="preview1">
                  <img id="preview-image1" src="<%= product.image[1] ? `/images/products/${product.image[1]}` : "/images/icon/default-image1.png" %>">
                  <input class="delete" type="checkbox" name="deleteImages" value=6 id="1" checked>
                </div>
                <input type="file" id="image1" name="image1" class="file">
                <label for="image1" class="file-agregar btn" onclick="document.getElementById(`1`).value = `1`;">Agregar</label>
                <button type="button" id="quitar" onclick="limpiar(`image1`,`preview-image1`,`1`)" class="file-quitar btn">Quitar</button>
              </div>

              <div class="mb-3 input-file">
                <div class="preview" id="preview2">
                  <img id="preview-image2" src="<%= product.image[2] ? `/images/products/${product.image[2]}` : "/images/icon/default-image1.png" %>">
                  <input class="delete" type="checkbox" name="deleteImages" value=6 id="2" checked>
                </div>
                <input type="file" id="image2" name="image2" class="file">
                <label for="image2" class="file-agregar btn" onclick="document.getElementById(`2`).value = `2`;">Agregar</label>
                <button type="button" id="quitar" onclick="limpiar(`image2`,`preview-image2`,`2`)" class="file-quitar btn">Quitar</button>
              </div>

              <div class="mb-3 input-file">
                <div class="preview" id="preview3">
                  <img id="preview-image3" src="<%= product.image[3] ? `/images/products/${product.image[3]}` : "/images/icon/default-image1.png" %>">
                  <input class="delete" type="checkbox" name="deleteImages" value=6 id="3" checked>
                </div>
                <input type="file" id="image3" name="image3" class="file">
                <label for="image3" class="file-agregar btn" onclick="document.getElementById(`3`).value = `3`;">Agregar</label>
                <button type="button" id="quitar" onclick="limpiar(`image3`,`preview-image3`,`3`)" class="file-quitar btn">Quitar</button>
              </div>

              <div class="mb-3 input-file">
                <div class="preview" id="preview4">
                  <img id="preview-image4" src="<%= product.image[4] ? `/images/products/${product.image[4]}` : "/images/icon/default-image1.png" %>">
                  <input class="delete" type="checkbox" name="deleteImages" value=6 id="4" checked>
                </div>
                <input type="file" id="image4" name="image4" class="file">
                <label for="image4" class="file-agregar btn" onclick="document.getElementById(`4`).value = `4`;">Agregar</label>
                <button type="button" id="quitar" onclick="limpiar(`image4`,`preview-image4`,`4`)" class="file-quitar btn">Quitar</button>
              </div>

            </div>
              
              <div class="container-inputs">
                  <div class="col-md-3 inputs-text">
                    <label for="name" class="form-label">Nombre :</label>
                    <input type="text" class="form-control <%= locals.errors && errors.name ? "is-invalid" : null%>" id="name" name="name" placeholder="Nombre" value="<%= typeof old != "undefined" ? old.name : product.name %>">
                    <div class="invalid-feedback" style="margin: 1vw 0;">
                      <%if(locals.errors && errors.name){%>
                        <%=errors.name.msg%>
                      <%}%>
                    </div>
                  </div>

                  <div class="mb-4 input-selects">
                    <label for="type" class="form-label">Tipo de producto :</label>
                    <select class="form-select" id="type" name="type">
                      <option selected hidden>Producto</option>
                      <%if(typeof old != "undefined" && old.type){%>
                        <option value="consolas" <%= "consolas" == old.type ? 'selected' : null %>>Consolas</option>
                        <option value="juegos" <%= "juegos" == old.type ? 'selected' : null %>>Juegos</option>
                        <option value="pc" <%= "pc" == old.type ? 'selected' : null %>>Pc armadas</option>
                      <%}else{%>
                        <option value="consolas" <%= "consolas" == product.type ? 'selected' : null %>>Consolas</option>
                        <option value="juegos" <%= "juegos" == product.type ? 'selected' : null %>>Juegos</option>
                        <option value="pc" <%= "pc" == product.type ? 'selected' : null %>>Pc armadas</option>
                      <%}%>
                    </select>
                    <div class="invalid-feedback" style="margin: 1vw 0;">
                      <%if(locals.errors && errors.type){%>
                        <%=errors.type.msg%>
                      <%}%>
                    </div>
                  </div>

                  <div class="mb-4 input-selects">
                    <label for="category" class="form-label">Categoria :</label>
                    <select class="form-select" id="category" name="category">
                      <option selected hidden>Categoria</option>
                      <%if(typeof old != "undefined" && old.type){%>
                        <option value="in-sale" <%= "in-sale" == old.category ? 'selected' : null %>>En oferta</option>
                        <option value="best-seller" <%= "best-seller" == old.category ? 'selected' : null %>>Mas vendido</option>
                        <option value="new-release" <%= "new-release" == old.category ? 'selected' : null %>>Nuevo lanzamiento</option>
                      <%}else{%>
                        <option value="in-sale" <%= "in-sale" == product.category ? 'selected' : null %>>En oferta</option>
                        <option value="best-seller" <%= "best-seller" == product.category ? 'selected' : null %>>Mas vendido</option>
                        <option value="new-release" <%= "new-release" == product.category ? 'selected' : null %>>Nuevo lanzamiento</option>
                      <%}%>
                    </select>
                    <div class="invalid-feedback" style="margin: 1vw 0;">
                      <%if(locals.errors && errors.category){%>
                        <%=errors.category.msg%>
                      <%}%>
                    </div>
                  </div>

                  <div class="col-md-3 inputs-text">
                    <label for="price" class="form-label">Precio :</label>
                    <input type="text" class="form-control <%= locals.errors && errors.price ? "is-invalid" : null%>" id="price" name="price" placeholder="Precio" value="<%= typeof old != "undefined" ? old.price : product.price %>">
                    <div class="invalid-feedback" style="margin: 1vw 0;">
                      <%if(locals.errors && errors.price){%>
                        <%=errors.price.msg%>
                      <%}%>
                    </div>
                  </div>

                  <div class="col-md-3 inputs-text">
                    <label for="discount" class="form-label">Descuento :</label>
                    <input type="text" class="form-control <%= locals.errors && errors.discount ? "is-invalid" : null%>" id="discount" name="discount"  placeholder="Descuento" value="<%= typeof old != "undefined" ? old.discount : product.discount %>">
                    <div class="invalid-feedback" style="margin: 1vw 0;">
                      <%if(locals.errors && errors.discount){%>
                        <%=errors.discount.msg%>
                      <%}%>
                    </div>
                  </div>
                 
                  <div class="mb-4 input-selects">
                    <label for="payMethod" class="form-label">Medio pago :</label>
                    <select class="form-select" id="payMethod" name="payMethod">
                      <option selected hidden>Medio de pago</option>
                      <option value="3" <%= "3" == product.payMethod ? 'selected' : null %>>3 cuotas</option>
                      <option value="6" <%= "6" == product.payMethod ? 'selected' : null %> >6 cuotas</option>
                      <option value="12"<%= "12" == product.payMethod ? 'selected' : null %>>12 cuotas</option>
                      <option value="0" <%= "0" == product.payMethod ? 'selected' : null %>>Efectivo</option>
                    </select>
                    <div class="invalid-feedback" style="margin: 1vw 0;">
                      <%if(locals.errors && errors.payMethod){%>
                        <%=errors.payMethod.msg%>
                      <%}%>
                    </div>
                  </div>
              </div>

              <div class="mb-3 input-text-area inputs-text">
                <label for="description" class="form-label">Descripcion :</label>
                <textarea class="form-control input-text-area <%= locals.errors && errors.description ? "is-invalid" : null%>" id="description" name="description" placeholder="Ingresa la descripcion del producto" rows="6"><%= typeof old != "undefined" ? old.description : product.description %></textarea>
                <div class="invalid-feedback" style="margin: 1vw 0;">
                  <%if(locals.errors && errors.description){%>
                    <%=errors.description.msg%>
                  <%}%>
                </div>
              </div>
  
            <!----------------------------------    BOOSTRAP   ------------------------------------------>
                
            <div class="container-buttons">
                <button type="submit" class="btn btn-editar">Guardar Producto</button>
                <a href="/products/detail/<%=product.id%>" class="btn btn-borrar">Cancelar</a>
            </div>
          </form>

    </main>
<%- include("./partials/footer") %> 
    <script src="/js/productLoading.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</body>
</html>