<!DOCTYPE html>
<html lang="es">
    <%- include("./partials/head",{title : product.name}) %> 

<body class="detail">
    
    <%- include("./partials/header") %> 
    <main>
        <div class="ruta">
            <a href="/">Inicio</a>
            <span>></span>
            <a href="#">Productos</a>
            <span>></span>
            <a class="a-posicion"href="/products/detail-Product"> <%=product.name%></a>
        </div>
        <section class="vista">
            <div class="div-img-miniaturas">
                <div class="vista-miniaturas">
                    <%product.images.forEach((image,index)=>{%>
                        <button onmouseover="document.getElementById(`imagePrincipal`).setAttribute(`src`,`/images/products/<%=image.name%>`)" id="tinyImage" class="b-miniatura"><img src="/images/products/<%=image.name%>" alt="image"></button>
                    <%})%>
                </div>
                <div class="contenedor-img vista-img">
                    <img id="imagePrincipal" src="/images/products/<%=product.images[0].name%> " alt="<%=product.name %> ">
                    <button class="fav"><i class="far fa-heart"></i></button>
                </div>
            </div>
            <div class="vista-info">

                <div class="c-name-category">
                    <h3> <%= product.name %> </h3>
                
                    <%if(product.category.name == "in-sale"){%>
                        <p class="vendido">Oferta</p>
                    <%}else if(product.category.name == "new-release"){%>
                        <p class="vendido">Lanzamiento</p>
                    <%}else{%>
                        <p class="vendido">Mas vendido</p>
                    <%}%>
                </div>
                <p class="product-detail-price small">
                    <%if (product.discount !== 0){%>
                        <span>$<%=toThousand(product.price)%></span>
                        /
                        <b><%=product.discount%>% OFF</b>
                    <%}%>
                </p>
                <p class="price">$ <%= toThousand(Math.round(product.price - ((product.discount / 100) * product.price))) %> </p>
                <div class="payMethod">
                    <p class="t-cuotas"> Hasta en 12 x $ <%=toThousand((product.price / 12).toFixed(0))%> sin interés</p>
                    <button class="b-cuotas">calcular cuotas</button>
                </div>
                <div class="envios">
                    <i class="fas fa-truck"></i>
                    <p class="t-envios">Envios a todo el pais</p>
                    <button class="b-envios">Ver costos de envio</button>
                </div>
                <div class="cantidad">
                    <p class="t-cantidad">Cantidad :</p>
                    <button><i class="fas fa-minus-circle"></i></button>
                    <p class="n-cantidad">01</p>
                    <button><i class="fas fa-plus-circle"></i></button>
                </div>
                <div class="div-comprar">
                    <% if (locals.userLogged && userLogged.access == '2') { %>
                        <a href="/products/edit/<%=product.id%>" class="b-editar">Editar</a>
                        <form action="/products/delete/<%=product.id%>?_method=DELETE" method="POST">
                            <button type="submit" class="b-borrar">Borrar</button>
                        </form>
                    <% }else{ %>
                        <!-- <a href="#" class="b-editar">Comprar</a>  -->
                        <!-- Button trigger modal -->
                        <button type="button" class="b-editar" data-bs-toggle="modal" data-bs-target="#exampleModal">
                            Comprar
                        </button>
                        
                        
                        <!-- Modal -->
                        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                            <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                ...
                                </div>
                                <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                <button type="button" class="btn ">Save changes</button>
                                </div>
                            </div>
                            </div>
                        </div>  
                        <a href="#" class="b-comprar">Agregar <i class="fas fa-cart-plus"></i></a>
                        <% } %> 
                        
                  

                </div>
            </div>
        </section>
        <section class="comentarios">
            <div class="div-stars">
                <button class="star"><i class="fas fa-star"></i></button>
                <button class="star"><i class="fas fa-star"></i></button>
                <button class="star"><i class="fas fa-star"></i></button>
                <button class="star"><i class="fas fa-star-half-alt"></i></button>
                <button class="star"><i class="far fa-star"></i></button>
            </div>

            <button class="b-comentarios">Ver comentarios</button>
        </section>
        <section class="info-detail">
            <div class="descripcion">
                <h2 class="text">Descripcion</h2>
            
                <div class="decoracion">
                    <!-- LINEA DECORATIVA -->
                </div>

                <p><%=product.description%> </p>
            </div>
           <!-- <div class="especificaciones">
                <h2>Especificaciones</h2>
            
                <div class="decoracion">
                    LINEA DECORATIVA
                </div>

                <div class="espec">
                    <img src="/images/icon/cpu.svg" alt="cpu">
                    <p>AMD Ryzen 3 3100</p>
                </div>
                <div class="espec">
                    <img src="/images/icon/mother.svg" alt="Motherboard">
                    <p>Motherboard Asus A320M-K AM4</p>
                </div>
                <div class="espec">
                    <img src="/images/icon/ram.svg" alt="memoria ram">
                    <p>Oloy OWL 8GB DDR4 3200Mhz Negra</p>
                </div>    
                <div class="espec">
                    <img src="/images/icon/gpu.svg" alt="gpu">
                    <p>ASUS GeForce GTX 1050 Ti 4GB</p>
                </div>
                <div class="espec">
                    <img src="/images/icon/almacenamiento.svg" alt="ssd">
                    <p>Ssd 240gb Kingston Interno A400 Sata</p>
                </div>
                <div class="espec">
                    <img src="/images/icon/fuente.svg" alt="fuente">
                    <p>Fuente Aerocool Cylon 600w 80 Plus Bronze</p>
                </div>
                <div class="espec">
                    <img src="/images/icon/gabo.svg" alt="gabinete">
                    <p> Xigmatek Eros Rgb Atx Vidrio Templado</p>
                </div>
            </div> -->
        </section>

        <h2>Productos Relacionados</h2>
        
        <div class="decoracion">
            <!-- LINEA DECORATIVA -->
        </div>

        <section class="productos">
            <%relatedProducts.forEach(relatedProduct => {%>
                <%if(relatedProduct.type.name == product.type.name){%>
                    <%if(relatedProduct.id !== product.id){%>
                        <article>
                            <a href="/products/detail/<%=relatedProduct.id%> " class="a-article">
                                <div class="contenedor-img">
                                    <img src="/images/products/<%=relatedProduct.images[0].name%>" alt="image">
                                </div>

                                <div class="product-info">
                                    <button><i class="far fa-heart"></i></button>

                                    <div class="title">
                                        <h3><%=relatedProduct.name %> </h3>
                                    </div>
                                    <div class="info">
                                        <p class="price">$ <%=toThousand(relatedProduct.price)%> </p>
                                        <%if (relatedProduct.discount !== 0){%>
                                            <span class="discount"><%=relatedProduct.discount%>% OFF</span>
                                        <%}%>
                                 
                                            <p class="payMethod">12 x $ <%=toThousand((relatedProduct.price / 12).toFixed(0))%> sin interés</p>
                                    
                                    </div>
                                </div>
                            </a>
                        </article>
                    <%}%>
                <%}%>
            <%})%>
        </section>
    </main>
    <%- include("./partials/footer") %> 
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</body>
</html>